From b0e3cff050bae97a7a1dcc79abcfc6dd38a308ec Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Ulf=20Palm=C3=A9r?= <ulf.palmer@flir.se>
Date: Fri, 19 Sep 2014 12:42:43 +0200
Subject: [PATCH 1/3] Fixed Makefile to match Yocto build
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Ulf Palm√©r <ulf.palmer@flir.se>
---
 Makefile.incl | 33 ++-------------------------------
 1 file changed, 2 insertions(+), 31 deletions(-)

diff --git a/Makefile.incl b/Makefile.incl
index 02763ad..47b68e6 100755
--- a/Makefile.incl
+++ b/Makefile.incl
@@ -4,20 +4,6 @@
 #  make ARCH=arm CROSS_COMPILE=arm-linux-
 #
 
-ifndef ARCH
-ARCH = x86
-endif
-
-ifndef CROSS_COMPILE
-ifeq ($(ARCH),arm)
-     $(error ARCH=arm, but no CROSS_COMPILE) 
-endif
-endif
-
-CC = $(CCACHE) $(CROSS_COMPILE)gcc
-CXX = $(CCACHE) $(CROSS_COMPILE)g++
-AR = $(CROSS_COMPILE)ar
-
 ifndef ALPHAREL
 ALPHAREL = ../..
 
@@ -31,15 +17,6 @@ ifeq "$(ALPHAFIRSTLET)"  "."
 endif	
 endif
 
-CPPCHECK = $(ALPHAREL)/bin/cppcheck
-CPPCHECKFLAGS = --template=gcc
-
-ifeq ($(USE_CPPCHECK),false)
-CPPCHECK_EXE = true
-else
-CPPCHECK_EXE = $(CPPCHECK)
-endif
-
 ifeq ($(origin NO_WARNERR), undefined)
      CFLAGS += -Werror -Wextra -c -DPOSIX -D_UNICODE -MMD -MP
 else
@@ -159,24 +136,18 @@ $(TARGETDIR):
 $(SHLIBDIR):
 	@mkdir -p $(SHLIBDIR)
 
-# Target for cppcheck
-$(CPPCHECK):
-	@$(MAKE) $(MAKERECFLAGS) -C $(ALPHAREL)/bin
-
 # Targets for compiling
-$(TARGETDIR)/%.o: $(SOURCEDIR)/%.cpp Makefile $(ALPHAREL)/make/Makefile.incl $(CPPCHECK)
+$(TARGETDIR)/%.o: $(SOURCEDIR)/%.cpp Makefile $(ALPHAREL)/make/Makefile.incl
 	@echo CXX $<
 	$(CXX) $(CFLAGS) $(INCLUDES) -o $@ $<
-	$(CPPCHECK_EXE) $(CPPCHECKFLAGS) $< 1>/dev/null
 
 $(TARGETDIR)/%.o: $(SOURCEDIR)/%.c Makefile $(ALPHAREL)/make/Makefile.incl
 	@echo CC $<
 	$(CC) $(CFLAGS) $(INCLUDES) -o $@ $<
 
-$(TARGETDIR)/%.o: %.cpp Makefile $(ALPHAREL)/make/Makefile.incl $(CPPCHECK)
+$(TARGETDIR)/%.o: %.cpp Makefile $(ALPHAREL)/make/Makefile.incl
 	@echo CXX $<
 	$(CXX) $(CFLAGS) $(INCLUDES) -o $@ $<
-	$(CPPCHECK_EXE) $(CPPCHECKFLAGS) $< 1>/dev/null
 
 $(TARGETDIR)/%.o: %.c Makefile $(ALPHAREL)/make/Makefile.incl
 	@echo CC $<
-- 
1.8.3.2


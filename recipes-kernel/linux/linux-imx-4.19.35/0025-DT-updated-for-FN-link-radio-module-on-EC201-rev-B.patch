From f2aa312515b0feb3b8f1f173654a73e60c47eeb4 Mon Sep 17 00:00:00 2001
From: Peter Fitger <peter.fitger@flir.se>
Date: Tue, 30 Apr 2019 13:41:40 +0200
Subject: [PATCH] DT updated for FN-link radio module on EC201 rev B

---
 arch/arm/boot/dts/imx7ulp-ec201.dtsi | 42 ++++++++++++++--------------
 1 file changed, 21 insertions(+), 21 deletions(-)

diff --git a/arch/arm/boot/dts/imx7ulp-ec201.dtsi b/arch/arm/boot/dts/imx7ulp-ec201.dtsi
index 900eb16efac8..a2a934d6ff9e 100644
--- a/arch/arm/boot/dts/imx7ulp-ec201.dtsi
+++ b/arch/arm/boot/dts/imx7ulp-ec201.dtsi
@@ -32,11 +32,23 @@
 		wlan_en_reg: wlan_en_reg {
 			compatible = "regulator-fixed";
 			regulator-name = "wl";
+			regulator-min-microvolt = <2700000>;
+			regulator-max-microvolt = <2700000>;
+			gpio = <&gpio_pte 6 GPIO_ACTIVE_HIGH>;
+			startup-delay-us = <70000>;
+			enable-active-high;
+		};
+
+		bt_en_reg: bt_en_reg {
+			compatible = "regulator-fixed";
+			regulator-name = "bt_en";
 			regulator-min-microvolt = <1800000>;
 			regulator-max-microvolt = <1800000>;
-			gpio = <&gpio_pte 6 GPIO_ACTIVE_HIGH>;
+			gpio = <&gpio_pte 15 GPIO_ACTIVE_HIGH>;
 			startup-delay-us = <70000>;
 			enable-active-high;
+			regulator-boot-on;
+			regulator-always-on;
 		};
 	};
 
@@ -66,7 +78,7 @@
 
 	mipi_dsi_reset: mipi-dsi-reset {
 		compatible = "gpio-reset";
-		reset-gpios = <&gpio_ptf 18 GPIO_ACTIVE_LOW>;   // Dummy GPIO, not used
+		reset-gpios = <&gpio_ptf 0 GPIO_ACTIVE_LOW>;   // Dummy GPIO, not used
 		reset-delay-us = <1000>;
 		#reset-cells = <0>;
 	};
@@ -113,18 +125,6 @@
 		m2_prio = <5>;		// Raise Cortex-M4 prio from 1 to 5
 		m5_prio = <5>;		// Raise VIU prio from 4 to 5
 	};
-	
-	kim {
-		compatible = "kim";
-		nshutdown-gpio = <&gpio_pte 12 GPIO_ACTIVE_HIGH>;
-		dev_name = "/dev/ttyLP2";
-		flow_cntrl = <1>;
-		baud_rate = <3000000>;
-	};
- 
-	btwilink {
-		compatible = "btwilink";
-	};
 };
 
 &cpu0 {
@@ -160,7 +160,6 @@
     	fsl,pins = <
  			IMX7ULP_PAD_PTC0__PTC0      0x20002  /* SHUTTER_IN */
  			IMX7ULP_PAD_PTC1__PTC1      0x20002  /* SHUTTER_OUT */
- 			IMX7ULP_PAD_PTE12__PTE12    0x3     /* BT_EN */
  			>;
 	};
 
@@ -219,6 +218,9 @@
 			IMX7ULP_PAD_PTE11__LPUART6_RX   0x3
 			IMX7ULP_PAD_PTE9__LPUART6_RTS_B 0x3
 			IMX7ULP_PAD_PTE8__LPUART6_CTS_B 0x3
+ 			IMX7ULP_PAD_PTE15__PTE15    	0x3     /* BT_EN */
+ 			IMX7ULP_PAD_PTF18__PTF18    	0x3     /* BT_WAKE_HOST */
+ 			IMX7ULP_PAD_PTF19__PTF19    	0x3     /* HOST_WAKE_BT */
 			>;
 	};
 
@@ -254,7 +256,7 @@
 
 	pinctrl_mipi_dsi_reset: mipi_dsi_reset_grp {
 		fsl,pins = <
-			IMX7ULP_PAD_PTF18__PTF18    0x3 /* Dummy */
+			IMX7ULP_PAD_PTF0__PTF0    0x3 /* Dummy */
 			>;
 	};
 
@@ -562,14 +564,12 @@
 	vmmc-supply = <&wlan_en_reg>;
 	#address-cells = <1>;
 	#size-cells = <0>;
-	max-frequency = <25000000>;
-	wlcore: wlcore@2 {
-		compatible = "ti,wl1837";
+	max-frequency = <12500000>;
+
+	qca9377: qca9377@2 {
 		reg = <2>;
 		interrupt-parent = <&gpio_pte>;
 		interrupts = <7 IRQ_TYPE_LEVEL_HIGH>;
-		tcxo-clock-frequency = <26000000>;
-		ref-clock-frequency = <26000000>;
 	};
 };
 
-- 
2.17.1


#@TYPE: Machine
#@NAME: Flir Systems Bellatrix Board
#@SOC: i.MX6DL
#@DESCRIPTION: Machine configuration for Flir Systems EC501 Board

# From imx6sabresd-common.inc:
require conf/machine/include/imx-base.inc
require conf/machine/include/tune-cortexa9.inc
SERIAL_CONSOLES = "115200;ttymxc0"

MACHINEOVERRIDES =. "mx6:mx6dl:"

UBOOT_MACHINE = "flir_ec501_config"
PREFERRED_PROVIDER_u-boot_ec501 = "u-boot-pingu"
PREFERRED_PROVIDER_virtual/bootloader_ec501 = "u-boot-pingu"
PREFERRED_RPROVIDER_u-boot-default-env = "u-boot-imx-mfgtool"
PREFERRED_PROVIDER_u-boot-default-env = "u-boot-imx-mfgtool"
UBOOT_MAKE_TARGET = "u-boot.imx"
UBOOT_MAKE_TARGET_pn-u-boot-pingu = "u-boot.imx"

#PREFERRED_PROVIDER_u-boot-fw-utils = "u-boot-fw-utils-pingu"

PREFERRED_PROVIDER_virtual/kernel_ec501 = "linux-pingu"
PREFERRED_VERSION_linux-pingu = "5.10%"

KERNEL_IMAGETYPE = "uImage"

SOC_FAMILY = "mx6:mx6dl"

# Platform u-boot settings
UBOOT_ENTRYPOINT = "0x10800000"
UBOOT_SUFFIX = "imx"

# Firmware
MACHINE_FIRMWARE ?= ""
# FIXME: Uncomment this?
#MACHINE_FIRMWARE_append = " firmware-imx-vpu-imx6q"

MACHINE_EXTRA_RDEPENDS += " \
    e2fsprogs \
    e2fsprogs-mke2fs \
"
MACHINE_EXTRA_RRECOMMENDS += "${MACHINE_FIRMWARE}"
MACHINE_EXTRA_RRECOMMENDS_remove = "kernel-module-nxp89xx linux-firmware-nxp89xx"
MACHINE_FEATURES="apm usbgadget vfat pci wifi rtc"

KERNEL_DEVICETREE = "imx6dl-beco.dtb \
		     imx6dl-blco.dtb \
		     imx6dl-ec501.dtb \
		     imx6dl-detcal.dtb \
		     imx6dl-hawk.dtb \
		     "


# Boot partition size for FAT image generation, 64MiB
BOARD_BOOTIMAGE_PARTITION_SIZE ?= "67108864"

MACHINE_GSTREAMER_PLUGIN = "gst1.0-fsl-plugin"

# This is more product specific than machine specific but...
# FLIR_OPTIONALS = "ipv6"
# Note that you also need ipv6 support in kernel config to enable ipv6 here

# Maybe un-orthodox? Masking in machine conf 

BBMASK .= "|.*meta-digi/"
BBMASK .= "|.*kernel-module-atheros/"
BBFILE_PATTERN_digi-arm = ""
BBFILE_PATTERN_dey = ""
BBFILE_PATTERN_fsl-demos = ""

IMAGE_FSTYPES = "tar.gz ext4"
From 58e0471647d6780ab1c1d938aaa65df22dfdef71 Mon Sep 17 00:00:00 2001
From: Felix Hammarstrand <felix.hammarstrand@flir.se>
Date: Tue, 26 Nov 2019 15:09:40 +0100
Subject: [PATCH] ec201 display: fix for slow display turn on: move sleep-out
 command last in startup sequence

---
 drivers/video/hx8394_vga.c         | 4 +++-
 drivers/video/mipi_dsi_northwest.c | 2 +-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/video/hx8394_vga.c b/drivers/video/hx8394_vga.c
index 5a3c913..56e23a0 100644
--- a/drivers/video/hx8394_vga.c
+++ b/drivers/video/hx8394_vga.c
@@ -29,7 +29,7 @@ struct reg_value {
 
 static struct reg_value lcd_setup[] =
 {
-	{0x05,150,0,{0x11}}, //Sleep out
+//	{0x15,0, 0,{0x35,0x01}}, //Tearing ON	
 	{0x29,0, 4,{0xB9,0xFF,0x83,0x94}}, //SETEXTC  extended command set access enable
 	{0x29,0,11,{0xB1,0x48,0x14,0x74,0x09,0x33,0x54,0x71,0x31,0x4D,0x2F}},  //SETPOWER
 	{0x29,0, 7,{0xBA,0x61,0x03,0x68,0x6B,0xB2,0xC0}}, //SETMIPI MIPI control: dsi 2-lane
@@ -52,6 +52,7 @@ static struct reg_value lcd_setup[] =
 	{0x29,0,45,{0xD6,0x19,0x19,0x21,0x20,0x18,0x18,0x18,0x18,0x18,0x18,0x01,0x00,0x03,\
 			0x02,0x05,0x04,0x07,0x06,0x25,0x24,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,\
 			0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18}}, 
+		
 	//SETGAMMA gamma curve related setting
 	{0x29,0,59,{0xE0,0x00,0x13,0x20,0x27,0x2C,0x2F,0x30,0x30,0x5E,0x6D,0x7C,0x78,0x7F,\
 			0x8E,0x92,0x94,0xA1,0xA4,0xA0,0xAE,0xBB,0x5C,0x59,0x5D,0x60,0x63,0x67,0x73,\
@@ -64,6 +65,7 @@ static struct reg_value lcd_setup[] =
 	{0x15,0, 0,{0xD4,0x02}}, //SETIOOPT Set I/O Option
 	{0x15,0, 0,{0xD2,0x77}}, //SETOFFSET
 	{0x15,0, 0,{0xC6,0xED}}, //??
+	{0x05,150,0,{0x11}}, //Sleep out
 	{0x05,50,0,{0x29}} //Display on
 };
 
diff --git a/drivers/video/mipi_dsi_northwest.c b/drivers/video/mipi_dsi_northwest.c
index 7817aa4..41be199 100644
--- a/drivers/video/mipi_dsi_northwest.c
+++ b/drivers/video/mipi_dsi_northwest.c
@@ -750,7 +750,7 @@ static int mipi_dsi_pkt_write(struct mipi_dsi_northwest_info *mipi_dsi,
 		printf("wait tx done timeout!\n");
 		return -ETIMEDOUT;
 	}
-	mdelay(10);
+	mdelay(1);
 
 	return 0;
 }
